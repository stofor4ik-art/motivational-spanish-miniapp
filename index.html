<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π –ò—Å–ø–∞–Ω—Å–∫–∏–π</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --color-primary: #3B82F6;
            --color-primary-hover: #2563EB;
            --color-primary-active: #1D4ED8;
            --color-bg: #0F172A;
            --color-surface: #1E293B;
            --color-text: #F1F5F9;
            --color-text-secondary: #94A3B8;
            --color-accent: #10B981;
            --color-accent-hover: #059669;
            --color-error: #EF4444;
            --color-warning: #F59E0B;
            --color-border: rgba(148, 163, 184, 0.15);
            --radius-base: 12px;
            --radius-lg: 16px;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --duration: 300ms;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0F172A 0%, #1A1F2E 100%);
            color: var(--color-text);
            min-height: 100vh;
            padding: 12px;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-top: 12px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #3B82F6, #10B981);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 14px;
            color: var(--color-text-secondary);
        }

        .status {
            text-align: center;
            font-size: 12px;
            color: var(--color-text-secondary);
            margin-bottom: 12px;
            min-height: 16px;
        }

        .status.syncing {
            color: var(--color-warning);
        }

        .status.synced {
            color: var(--color-accent);
        }

        .card-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .card {
            background: linear-gradient(135deg, #1E293B 0%, #2D3E50 100%);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: 32px 24px;
            box-shadow: var(--shadow-md);
            animation: slideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            width: 100%;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card-spanish {
            font-size: 32px;
            font-weight: 700;
            color: var(--color-primary);
            text-align: center;
            line-height: 1.4;
            margin-bottom: 24px;
            word-wrap: break-word;
        }

        .card-russian {
            text-align: center;
            margin-bottom: 16px;
            transition: all var(--duration) ease;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .card-russian.hidden {
            opacity: 0;
            pointer-events: none;
            transform: scaleY(0.8);
        }

        .card-russian-text {
            font-size: 18px;
            font-weight: 500;
            color: var(--color-text);
            margin-bottom: 12px;
        }

        .card-topic {
            font-size: 12px;
            color: var(--color-text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            background: rgba(59, 130, 246, 0.15);
            padding: 6px 12px;
            border-radius: 20px;
            margin-top: 12px;
        }

        .card-counter {
            text-align: center;
            font-size: 12px;
            color: var(--color-text-secondary);
            margin-top: 16px;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            min-width: 100px;
            padding: 12px 16px;
            border: none;
            border-radius: var(--radius-base);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--duration) ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:active {
            background: var(--color-primary-active);
            transform: translateY(0);
        }

        .btn-secondary {
            background: transparent;
            color: var(--color-text);
            border: 1.5px solid var(--color-border);
        }

        .btn-secondary:hover {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--color-primary);
        }

        .btn-accent {
            background: rgba(16, 185, 129, 0.15);
            color: var(--color-accent);
            border: 1.5px solid rgba(16, 185, 129, 0.3);
        }

        .btn-accent:hover {
            background: rgba(16, 185, 129, 0.25);
            border-color: var(--color-accent);
        }

        .btn-accent.active {
            background: var(--color-accent);
            color: white;
            border-color: var(--color-accent);
        }

        .filters {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            overflow-x: auto;
            padding-bottom: 8px;
            scroll-behavior: smooth;
        }

        .filter-btn {
            padding: 8px 14px;
            border: 1.5px solid var(--color-border);
            border-radius: 20px;
            background: transparent;
            color: var(--color-text-secondary);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: all var(--duration) ease;
            text-transform: capitalize;
        }

        .filter-btn:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .filter-btn.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .stat-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            padding: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--color-accent);
        }

        .stat-label {
            font-size: 11px;
            color: var(--color-text-secondary);
            margin-top: 4px;
            text-transform: uppercase;
        }

        .favorites-section {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .favorites-section.open {
            max-height: 400px;
        }

        .favorites-list {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            padding: 12px;
            margin-bottom: 16px;
            max-height: 200px;
            overflow-y: auto;
        }

        .favorite-item {
            padding: 12px;
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all var(--duration) ease;
        }

        .favorite-item:hover {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--color-primary);
        }

        .favorite-item:last-child {
            margin-bottom: 0;
        }

        .favorite-spanish {
            font-weight: 600;
            color: var(--color-primary);
            flex: 1;
        }

        .favorite-remove {
            background: transparent;
            border: none;
            color: var(--color-error);
            cursor: pointer;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all var(--duration) ease;
        }

        .favorite-remove:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .empty-state {
            text-align: center;
            padding: 24px;
            color: var(--color-text-secondary);
            font-size: 14px;
        }

        .toggle-favorites {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: color var(--duration) ease;
        }

        .toggle-favorites:hover {
            color: var(--color-accent);
        }

        @media (max-width: 480px) {
            .card-spanish {
                font-size: 24px;
            }

            .card-russian-text {
                font-size: 16px;
            }

            .header h1 {
                font-size: 24px;
            }

            .button-group {
                gap: 8px;
            }

            .btn {
                padding: 10px 12px;
                font-size: 13px;
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(59, 130, 246, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.3);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(59, 130, 246, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üá™üá∏ –ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π –ò—Å–ø–∞–Ω—Å–∫–∏–π</h1>
            <p>–ö–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –Ω–æ–≤–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–æ–º</p>
        </div>

        <div class="status" id="status"></div>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-value" id="totalCards">102</div>
                <div class="stat-label">–§—Ä–∞–∑</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="favoriteCount">0</div>
                <div class="stat-label">–ò–∑–±—Ä–∞–Ω–Ω—ã–µ</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="studiedToday">0</div>
                <div class="stat-label">–°–µ–≥–æ–¥–Ω—è</div>
            </div>
        </div>

        <div class="filters">
            <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
            <button class="filter-btn" data-filter="–º–æ—Ç–∏–≤–∞—Ü–∏—è">–ú–æ—Ç–∏–≤–∞—Ü–∏—è</button>
            <button class="filter-btn" data-filter="—É—á—ë–±–∞">–£—á—ë–±–∞</button>
            <button class="filter-btn" data-filter="–∂–∏–∑–Ω—å">–ñ–∏–∑–Ω—å</button>
            <button class="filter-btn" data-filter="–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</button>
        </div>

        <div class="card-container">
            <div class="card">
                <div>
                    <div class="card-spanish" id="cardSpanish">S√≠ se puede</div>
                    <div class="card-russian" id="cardRussian">
                        <div class="card-russian-text" id="cardRussianText">–î–∞, —Ç—ã –º–æ–∂–µ—à—å</div>
                        <span class="card-topic" id="cardTopic">–º–æ—Ç–∏–≤–∞—Ü–∏—è</span>
                    </div>
                </div>
                <div class="card-counter">
                    <span id="cardCounter">1 –∏–∑ 102</span>
                </div>
            </div>
        </div>

        <div class="button-group">
            <button class="btn btn-secondary" id="prevBtn">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è</button>
            <button class="btn btn-primary" id="nextBtn">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</button>
        </div>

        <div class="button-group">
            <button class="btn btn-secondary" id="toggleTranslationBtn">üëÅ –ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>
            <button class="btn btn-accent" id="favoriteBtn">‚ô° –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
        </div>

        <div class="toggle-favorites" id="toggleFavoritesBtn">
            <span>‚òÖ –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã</span>
            <span style="font-size: 16px;">‚ñº</span>
        </div>

        <div class="favorites-section" id="favoritesSection">
            <div class="favorites-list" id="favoritesList">
                <div class="empty-state">–ù–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑</div>
            </div>
        </div>
    </div>

    <script>
        // ============ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ============
        const API_BASE = 'http://localhost:3000';
        const SYNC_INTERVAL = 30000; // 30 —Å–µ–∫—É–Ω–¥

        // ============ –î–ê–ù–ù–´–ï ============
        const cards = [
            { id: 1, es: "S√≠ se puede", ru: "–î–∞, —Ç—ã –º–æ–∂–µ—à—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 2, es: "Cree en ti", ru: "–í–µ—Ä—å –≤ —Å–µ–±—è", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 3, es: "Eres capaz", ru: "–¢—ã —Å–ø–æ—Å–æ–±–µ–Ω(–Ω–∞)", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 4, es: "Vales mucho", ru: "–¢—ã –º–Ω–æ–≥–æ–≥–æ —Å—Ç–æ–∏—à—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 5, es: "Nunca te rindas", ru: "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 6, es: "Paso a paso", ru: "–®–∞–≥ –∑–∞ —à–∞–≥–æ–º", topic: "—É—á—ë–±–∞" },
            { id: 7, es: "Conf√≠a en el proceso", ru: "–î–æ–≤–µ—Ä—å—Å—è –ø—Ä–æ—Ü–µ—Å—Å—É", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 8, es: "Todo es posible", ru: "–í—Å—ë –≤–æ–∑–º–æ–∂–Ω–æ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 9, es: "T√∫ puedes m√°s", ru: "–¢—ã –º–æ–∂–µ—à—å –±–æ–ª—å—à–µ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 10, es: "Sigue adelante", ru: "–ò–¥–∏ –¥–∞–ª—å—à–µ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 11, es: "Cada d√≠a cuenta", ru: "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ", topic: "—É—á—ë–±–∞" },
            { id: 12, es: "Aprende de tus errores", ru: "–£—á–∏—Å—å –Ω–∞ —Å–≤–æ–∏—Ö –æ—à–∏–±–∫–∞—Ö", topic: "—É—á—ë–±–∞" },
            { id: 13, es: "El tiempo lo cura todo", ru: "–í—Ä–µ–º—è –ª–µ—á–∏—Ç –≤—Å—ë", topic: "–∂–∏–∑–Ω—å" },
            { id: 14, es: "Al mal tiempo, buena cara", ru: "–£–ª—ã–±–∞–π—Å—è –≤ —Ç—Ä—É–¥–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞", topic: "–∂–∏–∑–Ω—å" },
            { id: 15, es: "M√°s vale tarde que nunca", ru: "–õ—É—á—à–µ –ø–æ–∑–¥–Ω–æ, —á–µ–º –Ω–∏–∫–æ–≥–¥–∞", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 16, es: "La pr√°ctica hace al maestro", ru: "–ü—Ä–∞–∫—Ç–∏–∫–∞ –¥–µ–ª–∞–µ—Ç –º–∞—Å—Ç–µ—Ä–∞", topic: "—É—á—ë–±–∞" },
            { id: 17, es: "Quien no arriesga, no gana", ru: "–ö—Ç–æ –Ω–µ —Ä–∏—Å–∫—É–µ—Ç, —Ç–æ—Ç –Ω–µ –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 18, es: "Poco a poco se va lejos", ru: "–ü–æ—Ç–∏—Ö–æ–Ω—å–∫—É –∑–∞–π–¥—ë—à—å –¥–∞–ª–µ–∫–æ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 19, es: "Hoy es un buen d√≠a para empezar", ru: "–°–µ–≥–æ–¥–Ω—è —Ö–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –Ω–∞—á–∞—Ç—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 20, es: "Nunca es tarde para aprender", ru: "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∑–¥–Ω–æ —É—á–∏—Ç—å—Å—è", topic: "—É—á—ë–±–∞" },
            { id: 21, es: "Todo esfuerzo tiene su recompensa", ru: "–õ—é–±–æ–µ —É—Å–∏–ª–∏–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–∞–µ—Ç—Å—è", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 22, es: "Haz lo mejor que puedas", ru: "–î–µ–ª–∞–π –≤—Å—ë, —á—Ç–æ –º–æ–∂–µ—à—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 23, es: "T√∫ eres tu mejor inversi√≥n", ru: "–¢—ã –ª—É—á—à–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è", topic: "–∂–∏–∑–Ω—å" },
            { id: 24, es: "Cree en tu camino", ru: "–í–µ—Ä—å –≤ —Å–≤–æ–π –ø—É—Ç—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 25, es: "No te compares con los dem√°s", ru: "–ù–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–π —Å –¥—Ä—É–≥–∏–º–∏", topic: "–∂–∏–∑–Ω—å" },
            { id: 26, es: "Cada error te hace m√°s fuerte", ru: "–û—à–∏–±–∫–∞ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è —Å–∏–ª—å–Ω–µ–µ", topic: "—É—á—ë–±–∞" },
            { id: 27, es: "Aprende algo nuevo hoy", ru: "–í—ã—É—á–∏ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ —Å–µ–≥–æ–¥–Ω—è", topic: "—É—á—ë–±–∞" },
            { id: 28, es: "El l√≠mite est√° en tu mente", ru: "–ü—Ä–µ–¥–µ–ª —Ç–æ–ª—å–∫–æ –≤ –≥–æ–ª–æ–≤–µ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 29, es: "Sue√±a en grande", ru: "–ú–µ—á—Ç–∞–π –ø–æ-–∫—Ä—É–ø–Ω–æ–º—É", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 30, es: "La constancia vence al talento", ru: "–£–ø–æ—Ä—Å—Ç–≤–æ –ø–æ–±–µ–∂–¥–∞–µ—Ç —Ç–∞–ª–∞–Ω—Ç", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 31, es: "El que madruga, Dios le ayuda", ru: "–†–∞–Ω–Ω–µ–º—É –ø—Ç–∞—à–∫–µ –ë–æ–≥ –ø–æ–º–æ–≥–∞–µ—Ç", topic: "–∂–∏–∑–Ω—å" },
            { id: 32, es: "Hazlo con pasi√≥n o no lo hagas", ru: "–î–µ–ª–∞–π —Å —Å—Ç—Ä–∞—Å—Ç—å—é –∏–ª–∏ –Ω–µ –¥–µ–ª–∞–π", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 33, es: "Tu futuro empieza hoy", ru: "–¢–≤–æ—ë –±—É–¥—É—â–µ–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–µ–≥–æ–¥–Ω—è", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 34, es: "La √∫nica forma de fallar es dejar de intentarlo", ru: "–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–∏–≥—Ä–∞—Ç—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 35, es: "Nunca pares de aprender", ru: "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–∫—Ä–∞—â–∞–π —É—á–∏—Ç—å—Å—è", topic: "—É—á—ë–±–∞" },
            { id: 36, es: "Cada palabra nueva es una puerta", ru: "–ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ ‚Äî –Ω–æ–≤–∞—è –¥–≤–µ—Ä—å", topic: "—É—á—ë–±–∞" },
            { id: 37, es: "Equivocarse es parte del aprendizaje", ru: "–û—à–∏–±–∞—Ç—å—Å—è ‚Äî —á–∞—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è", topic: "—É—á—ë–±–∞" },
            { id: 38, es: "Tu progreso importa m√°s que la perfecci√≥n", ru: "–ü—Ä–æ–≥—Ä–µ—Å—Å –≤–∞–∂–Ω–µ–µ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 39, es: "Hoy mejor que ayer, ma√±ana mejor que hoy", ru: "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –ª—É—á—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 40, es: "Haz de tu meta un h√°bito", ru: "–°–¥–µ–ª–∞–π —Ü–µ–ª—å –ø—Ä–∏–≤—ã—á–∫–æ–π", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 41, es: "El camino se hace al andar", ru: "–î–æ—Ä–æ–≥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –∏–¥—ë—à—å", topic: "–∂–∏–∑–Ω—å" },
            { id: 42, es: "Con cada frase, eres m√°s fuerte", ru: "–° –∫–∞–∂–¥–æ–π —Ñ—Ä–∞–∑–æ–π —Å–∏–ª—å–Ω–µ–µ", topic: "—É—á—ë–±–∞" },
            { id: 43, es: "Los peque√±os pasos crean grandes cambios", ru: "–ú–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏ ‚Äî –±–æ–ª—å—à–∏–µ –ø–µ—Ä–µ–º–µ–Ω—ã", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 44, es: "Tu esfuerzo de hoy ser√° tu orgullo ma√±ana", ru: "–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π —Ç—Ä—É–¥ ‚Äî –∑–∞–≤—Ç—Ä–∞—à–Ω—è—è –≥–æ—Ä–¥–æ—Å—Ç—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 45, es: "Atr√©vete a intentarlo", ru: "–û—Å–º–µ–ª—å—Å—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 46, es: "Tu disciplina te acerca a tus sue√±os", ru: "–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç –º–µ—á—Ç—ã", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 47, es: "Cada minuto que estudias cuenta", ru: "–ö–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞ —É—á—ë–±—ã –≤–∞–∂–Ω–∞", topic: "—É—á—ë–±–∞" },
            { id: 48, es: "Rod√©ate de buenas palabras", ru: "–û–∫—Ä—É–∂–∏ —Å–µ–±—è —Ö–æ—Ä–æ—à–∏–º–∏ —Å–ª–æ–≤–∞–º–∏", topic: "–∂–∏–∑–Ω—å" },
            { id: 49, es: "Cree en tu capacidad de aprender", ru: "–í–µ—Ä—å –≤ —Å–≤–æ—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É—á–∏—Ç—å—Å—è", topic: "—É—á—ë–±–∞" },
            { id: 50, es: "Lo importante es no rendirse", ru: "–ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ —Å–¥–∞–≤–∞—Ç—å—Å—è", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 51, es: "No tengas miedo de equivocarte", ru: "–ù–µ –±–æ–π—Å—è –æ—à–∏–±–∞—Ç—å—Å—è", topic: "—É—á—ë–±–∞" },
            { id: 52, es: "Preguntar es parte de aprender", ru: "–°–ø—Ä–∞—à–∏–≤–∞—Ç—å ‚Äî —á–∞—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è", topic: "—É—á—ë–±–∞" },
            { id: 53, es: "Cada idioma es una nueva vida", ru: "–ö–∞–∂–¥—ã–π —è–∑—ã–∫ ‚Äî –Ω–æ–≤–∞—è –∂–∏–∑–Ω—å", topic: "—É—á—ë–±–∞" },
            { id: 54, es: "Habla sin miedo", ru: "–ì–æ–≤–æ—Ä–∏ –±–µ–∑ —Å—Ç—Ä–∞—Ö–∞", topic: "—É—á—ë–±–∞" },
            { id: 55, es: "Usa el espa√±ol cada d√≠a", ru: "–ò—Å–ø–æ–ª—å–∑—É–π –∏—Å–ø–∞–Ω—Å–∫–∏–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å", topic: "—É—á—ë–±–∞" },
            { id: 56, es: "Repetir es recordar", ru: "–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ ‚Äî –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ", topic: "—É—á—ë–±–∞" },
            { id: 57, es: "Tu acento es tu historia", ru: "–¢–≤–æ–π –∞–∫—Ü–µ–Ω—Ç ‚Äî —á–∞—Å—Ç—å –∏—Å—Ç–æ—Ä–∏–∏", topic: "—É—á—ë–±–∞" },
            { id: 58, es: "Escucha m√°s, entender√°s m√°s", ru: "–°–ª—É—à–∞–π –±–æ–ª—å—à–µ ‚Äî –ø–æ–π–º—ë—à—å –±–æ–ª—å—à–µ", topic: "—É—á—ë–±–∞" },
            { id: 59, es: "Leer te abre la mente", ru: "–ß—Ç–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞–∑—É–º", topic: "—É—á—ë–±–∞" },
            { id: 60, es: "Equiv√≥cate en espa√±ol, pero habla", ru: "–û—à–∏–±–∞–π—Å—è, –Ω–æ –≥–æ–≤–æ—Ä–∏ –ø–æ-–∏—Å–ø–∞–Ω—Å–∫–∏", topic: "—É—á—ë–±–∞" },
            { id: 61, es: "Un d√≠a sin aprender es un d√≠a perdido", ru: "–î–µ–Ω—å –±–µ–∑ —É—á—ë–±—ã ‚Äî –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–π –¥–µ–Ω—å", topic: "—É—á—ë–±–∞" },
            { id: 62, es: "Tu esfuerzo marca la diferencia", ru: "–¢–≤–æ–∏ —É—Å–∏–ª–∏—è –¥–µ–ª–∞—é—Ç —Ä–∞–∑–Ω–∏—Ü—É", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 63, es: "El √©xito es la suma de peque√±os esfuerzos", ru: "–£—Å–ø–µ—Ö ‚Äî —Å—É–º–º–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —É—Å–∏–ª–∏–π", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 64, es: "Aprende para ti, no para los dem√°s", ru: "–£—á–∏—Å—å –¥–ª—è —Å–µ–±—è, –Ω–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö", topic: "—É—á—ë–±–∞" },
            { id: 65, es: "Celebra cada peque√±o progreso", ru: "–û—Ç–º–µ—á–∞–π –∫–∞–∂–¥—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 66, es: "No te detengas ahora", ru: "–ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è —Å–µ–π—á–∞—Å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 67, es: "Empieza donde est√°s, usa lo que tienes", ru: "–ù–∞—á–Ω–∏ —Ç–∞–º, –≥–¥–µ —Ç—ã –µ—Å—Ç—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 68, es: "Tu mejor versi√≥n est√° en camino", ru: "–¢–≤–æ—è –ª—É—á—à–∞—è –≤–µ—Ä—Å–∏—è —É–∂–µ –≤ –ø—É—Ç–∏", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 69, es: "Aprende a disfrutar del proceso", ru: "–ù–∞—É—á–∏—Å—å –ø–æ–ª—É—á–∞—Ç—å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ", topic: "—É—á—ë–±–∞" },
            { id: 70, es: "Lo que hoy te cuesta, ma√±ana ser√° f√°cil", ru: "–°–ª–æ–∂–Ω–æ–µ —Å—Ç–∞–Ω–µ—Ç –ª—ë–≥–∫–∏–º", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 71, es: "Tu paciencia es tu fuerza", ru: "–¢–≤–æ—ë —Ç–µ—Ä–ø–µ–Ω–∏–µ ‚Äî —Ç–≤–æ—è —Å–∏–ª–∞", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 72, es: "Cada frase te acerca a la fluidez", ru: "–ö–∞–∂–¥–∞—è —Ñ—Ä–∞–∑–∞ ‚Äî —à–∞–≥ –∫ —Å–≤–æ–±–æ–¥–Ω–æ–π —Ä–µ—á–∏", topic: "—É—á—ë–±–∞" },
            { id: 73, es: "No importa lo lento que vayas, si no te detienes", ru: "–ù–µ –≤–∞–∂–Ω–æ –∫–∞–∫ –º–µ–¥–ª–µ–Ω–Ω–æ, –≥–ª–∞–≤–Ω–æ–µ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 74, es: "Tus metas valen el esfuerzo", ru: "–¢–≤–æ–∏ —Ü–µ–ª–∏ —Å—Ç–æ—è—Ç —É—Å–∏–ª–∏–π", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 75, es: "Los errores son maestros", ru: "–û—à–∏–±–∫–∏ ‚Äî —É—á–∏—Ç–µ–ª—è", topic: "—É—á—ë–±–∞" },
            { id: 76, es: "Conf√≠a en lo que ya sabes", ru: "–î–æ–≤–µ—Ä—å—Å—è —Ç–æ–º—É, —á—Ç–æ –∑–Ω–∞–µ—à—å", topic: "—É—á—ë–±–∞" },
            { id: 77, es: "Cada d√≠a puedes aprender algo nuevo", ru: "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ", topic: "—É—á—ë–±–∞" },
            { id: 78, es: "Hablar es practicar", ru: "–ì–æ–≤–æ—Ä–∏—Ç—å ‚Äî —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏–∫–∞", topic: "—É—á—ë–±–∞" },
            { id: 79, es: "Tus dudas no definen tu potencial", ru: "–°–æ–º–Ω–µ–Ω–∏—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 80, es: "Tu constancia es tu superpoder", ru: "–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ ‚Äî —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 81, es: "Aprende de ayer, vive hoy, sue√±a ma√±ana", ru: "–£—á–∏—Å—å –≤—á–µ—Ä–∞—à–Ω–µ–º—É, –∂–∏–≤–∏ —Å–µ–≥–æ–¥–Ω—è", topic: "–∂–∏–∑–Ω—å" },
            { id: 82, es: "Tu progreso es √∫nico", ru: "–¢–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å —É–Ω–∏–∫–∞–ª–µ–Ω", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 83, es: "No te subestimes", ru: "–ù–µ –Ω–µ–¥–æ–æ—Ü–µ–Ω–∏–≤–∞–π —Å–µ–±—è", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 84, es: "Disfruta cada nueva palabra", ru: "–ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∫–∞–∂–¥—ã–º –Ω–æ–≤—ã–º —Å–ª–æ–≤–æ–º", topic: "—É—á—ë–±–∞" },
            { id: 85, es: "Haz del espa√±ol parte de tu vida", ru: "–°–¥–µ–ª–∞–π –∏—Å–ø–∞–Ω—Å–∫–∏–π —á–∞—Å—Ç—å—é –∂–∏–∑–Ω–∏", topic: "—É—á—ë–±–∞" },
            { id: 86, es: "Tus ganas de aprender ya son un √©xito", ru: "–ñ–µ–ª–∞–Ω–∏–µ —É—á–∏—Ç—å—Å—è —É–∂–µ —É—Å–ø–µ—Ö", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 87, es: "Hoy estudias, ma√±ana lo vives", ru: "–°–µ–≥–æ–¥–Ω—è —É—á–∏—à—å, –∑–∞–≤—Ç—Ä–∞ –∂–∏–≤—ë—à—å", topic: "—É—á—ë–±–∞" },
            { id: 88, es: "El conocimiento es libertad", ru: "–ó–Ω–∞–Ω–∏–µ ‚Äî —ç—Ç–æ —Å–≤–æ–±–æ–¥–∞", topic: "–∂–∏–∑–Ω—å" },
            { id: 89, es: "Tu esfuerzo inspira a otros", ru: "–¢–≤–æ–∏ —É—Å–∏–ª–∏—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—Ç", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 90, es: "No hay aprendizaje sin pr√°ctica", ru: "–ù–µ—Ç –æ–±—É—á–µ–Ω–∏—è –±–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏", topic: "—É—á—ë–±–∞" },
            { id: 91, es: "Cada vez que repites, mejoras", ru: "–° –∫–∞–∂–¥—ã–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ–º ‚Äî –ª—É—á—à–µ", topic: "—É—á—ë–±–∞" },
            { id: 92, es: "No temas equivocarte en p√∫blico", ru: "–ù–µ –±–æ–π—Å—è –æ—à–∏–±–æ–∫ –Ω–∞ –ø—É–±–ª–∏–∫–µ", topic: "—É—á—ë–±–∞" },
            { id: 93, es: "Tu valent√≠a te hace avanzar", ru: "–°–º–µ–ª–æ—Å—Ç—å –¥–≤–∏–≥–∞–µ—Ç –≤–ø–µ—Ä—ë–¥", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 94, es: "Aprende a tu ritmo", ru: "–£—á–∏—Å—å –≤ —Å–≤–æ—ë–º —Ç–µ–º–ø–µ", topic: "—É—á—ë–±–∞" },
            { id: 95, es: "El espa√±ol es tu nueva herramienta", ru: "–ò—Å–ø–∞–Ω—Å–∫–∏–π ‚Äî –Ω–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç", topic: "—É—á—ë–±–∞" },
            { id: 96, es: "Cada d√≠a de estudio es una victoria", ru: "–î–µ–Ω—å —É—á—ë–±—ã ‚Äî –ø–æ–±–µ–¥–∞", topic: "—É—á—ë–±–∞" },
            { id: 97, es: "Lo dif√≠cil de hoy ser√° tu orgullo ma√±ana", ru: "–¢—Ä—É–¥–Ω–æ–µ —Å—Ç–∞–Ω–µ—Ç –≥–æ—Ä–¥–æ—Å—Ç—å—é", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 98, es: "Conf√≠a en tu progreso", ru: "–í–µ—Ä—å –≤ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 99, es: "Eres m√°s constante de lo que crees", ru: "–¢—ã –±–æ–ª–µ–µ —É–ø–æ—Ä–µ–Ω, —á–µ–º –¥—É–º–∞–µ—à—å", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 100, es: "Este es solo el comienzo", ru: "–≠—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" },
            { id: 101, es: "Tu espa√±ol mejora con cada paso", ru: "–ò—Å–ø–∞–Ω—Å–∫–∏–π —É–ª—É—á—à–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥—ã–º —à–∞–≥–æ–º", topic: "—É—á—ë–±–∞" },
            { id: 102, es: "Gracias por seguir adelante", ru: "–°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –∏–¥—ë—à—å –¥–∞–ª—å—à–µ", topic: "–º–æ—Ç–∏–≤–∞—Ü–∏—è" }
        ];

        // ============ –°–û–°–¢–û–Ø–ù–ò–ï ============
        let currentIndex = 0;
        let filteredCards = [...cards];
        let showTranslation = true;
        let favorites = [];
        let studiedToday = 0;
        let totalStudied = 0;
        let lastStudyDate = new Date().toDateString();
        let userId = null;
        let initData = null;
        let isSyncing = false;

        // ============ DOM –≠–õ–ï–ú–ï–ù–¢–´ ============
        const cardSpanish = document.getElementById('cardSpanish');
        const cardRussian = document.getElementById('cardRussian');
        const cardRussianText = document.getElementById('cardRussianText');
        const cardTopic = document.getElementById('cardTopic');
        const cardCounter = document.getElementById('cardCounter');
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');
        const toggleTranslationBtn = document.getElementById('toggleTranslationBtn');
        const favoriteBtn = document.getElementById('favoriteBtn');
        const toggleFavoritesBtn = document.getElementById('toggleFavoritesBtn');
        const favoritesSection = document.getElementById('favoritesSection');
        const favoritesList = document.getElementById('favoritesList');
        const favoriteCount = document.getElementById('favoriteCount');
        const studiedTodayEl = document.getElementById('studiedToday');
        const statusEl = document.getElementById('status');
        const filterBtns = document.querySelectorAll('.filter-btn');

        // ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TELEGRAM WEBAPP ============
        function initTelegramWebApp() {
            if (window.Telegram?.WebApp) {
                const twa = window.Telegram.WebApp;
                twa.ready();
                twa.expand();
                
                initData = twa.initData;
                if (twa.initDataUnsafe?.user) {
                    userId = twa.initDataUnsafe.user.id;
                    console.log('‚úì Telegram UserID:', userId);
                }
                
                document.documentElement.style.setProperty('--color-primary', twa.themeParams?.button_color || '#3B82F6');
            } else {
                console.warn('‚ö†Ô∏è –ù–µ –≤ Telegram WebApp');
                initData = 'test_data=1&user=' + JSON.stringify({id: 123456789, username: 'testuser'});
            }
            
            loadFromServer();
        }

        // ============ API –§–£–ù–ö–¶–ò–ò ============
        async function loadFromServer() {
            try {
                updateStatus('–ó–∞–≥—Ä—É–∑–∫–∞...', 'syncing');
                
                const response = await fetch(`${API_BASE}/api/user/progress`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ initData })
                });

                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                
                const data = await response.json();
                
                if (data.success) {
                    favorites = data.data.favorites || [];
                    currentIndex = data.data.currentIndex || 0;
                    studiedToday = data.data.studiedToday || 0;
                    totalStudied = data.data.totalStudied || 0;
                    
                    updateStatus('‚úì –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ', 'synced');
                    setTimeout(() => updateStatus(''), 2000);
                }
                
                updateUI();
                updateStats();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                updateStatus('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', '');
                loadFromLocalStorage();
            }
        }

        async function syncToServer() {
            if (isSyncing) return;
            
            try {
                isSyncing = true;
                
                const response = await fetch(`${API_BASE}/api/user/sync`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        initData,
                        favorites,
                        currentIndex,
                        studiedToday,
                        totalStudied
                    })
                });

                if (response.ok) {
                    console.log('‚úì –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞');
                    updateStatus('‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ', 'synced');
                    setTimeout(() => updateStatus(''), 2000);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error);
                updateStatus('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å', '');
            } finally {
                isSyncing = false;
            }
        }

        function loadFromLocalStorage() {
            favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            currentIndex = parseInt(localStorage.getItem('currentIndex') || '0');
            studiedToday = parseInt(localStorage.getItem('studiedToday') || '0');
            totalStudied = parseInt(localStorage.getItem('totalStudied') || '0');
            lastStudyDate = localStorage.getItem('lastStudyDate') || new Date().toDateString();
            
            const today = new Date().toDateString();
            if (today !== lastStudyDate) {
                studiedToday = 0;
                localStorage.setItem('lastStudyDate', today);
            }
        }

        function saveToLocalStorage() {
            localStorage.setItem('favorites', JSON.stringify(favorites));
            localStorage.setItem('currentIndex', currentIndex);
            localStorage.setItem('studiedToday', studiedToday);
            localStorage.setItem('totalStudied', totalStudied);
        }

        // ============ UI –§–£–ù–ö–¶–ò–ò ============
        function updateStatus(message, className) {
            statusEl.textContent = message;
            statusEl.className = 'status ' + className;
        }

        function updateUI() {
            const card = filteredCards[currentIndex];
            cardSpanish.textContent = card.es;
            cardRussianText.textContent = card.ru;
            cardTopic.textContent = card.topic;
            cardCounter.textContent = `${currentIndex + 1} –∏–∑ ${filteredCards.length}`;
            
            updateTranslationVisibility();
            updateFavoriteButton();
        }

        function updateTranslationVisibility() {
            if (showTranslation) {
                cardRussian.classList.remove('hidden');
            } else {
                cardRussian.classList.add('hidden');
            }
        }

        function updateFavoriteButton() {
            const currentCard = filteredCards[currentIndex];
            const isFavorite = favorites.some(f => f.id === currentCard.id);
            
            if (isFavorite) {
                favoriteBtn.textContent = '‚òÖ –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º';
                favoriteBtn.classList.add('active');
            } else {
                favoriteBtn.textContent = '‚ô° –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ';
                favoriteBtn.classList.remove('active');
            }
        }

        function updateStats() {
            favoriteCount.textContent = favorites.length;
            studiedTodayEl.textContent = studiedToday;
        }

        function recordStudy() {
            if (studiedToday < cards.length) {
                studiedToday++;
                totalStudied++;
                saveToLocalStorage();
                syncToServer();
                updateStats();
            }
        }

        function renderFavorites() {
            if (favorites.length === 0) {
                favoritesList.innerHTML = '<div class="empty-state">–ù–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑</div>';
                return;
            }

            favoritesList.innerHTML = favorites.map(fav => `
                <div class="favorite-item" data-id="${fav.id}">
                    <span class="favorite-spanish">${fav.es}</span>
                    <button class="favorite-remove" data-id="${fav.id}">‚úï</button>
                </div>
            `).join('');

            // –ö–ª–∏–∫–∏ –Ω–∞ —Ñ—Ä–∞–∑—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º
            document.querySelectorAll('.favorite-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    if (e.target.classList.contains('favorite-remove')) return;
                    
                    const cardId = parseInt(item.dataset.id);
                    const cardIndex = filteredCards.findIndex(c => c.id === cardId);
                    
                    if (cardIndex === -1) {
                        // –ï—Å–ª–∏ —Ñ—Ä–∞–∑–∞ –Ω–µ –≤ —Ç–µ–∫—É—â–µ–º —Ñ–∏–ª—å—Ç—Ä–µ, –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ "–í—Å–µ"
                        filterBtns.forEach(btn => {
                            if (btn.dataset.filter === 'all') {
                                btn.click();
                            }
                        });
                        setTimeout(() => {
                            currentIndex = cards.findIndex(c => c.id === cardId);
                            updateUI();
                        }, 0);
                    } else {
                        currentIndex = cardIndex;
                        updateUI();
                    }
                    
                    favoritesSection.classList.remove('open');
                });
            });

            // –ö–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
            document.querySelectorAll('.favorite-remove').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const id = parseInt(btn.dataset.id);
                    favorites = favorites.filter(f => f.id !== id);
                    saveToLocalStorage();
                    syncToServer();
                    updateStats();
                    renderFavorites();
                });
            });
        }

        // ============ –°–û–ë–´–¢–ò–Ø ============
        nextBtn.addEventListener('click', () => {
            currentIndex = (currentIndex + 1) % filteredCards.length;
            updateUI();
            recordStudy();
            saveToLocalStorage();
            syncToServer();
        });

        prevBtn.addEventListener('click', () => {
            currentIndex = (currentIndex - 1 + filteredCards.length) % filteredCards.length;
            updateUI();
            saveToLocalStorage();
            syncToServer();
        });

        toggleTranslationBtn.addEventListener('click', () => {
            showTranslation = !showTranslation;
            updateTranslationVisibility();
            toggleTranslationBtn.textContent = showTranslation ? 'üëÅ –ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥' : 'üëÅ‚Äçüó® –°–∫—Ä—ã—Ç—å –ø–µ—Ä–µ–≤–æ–¥';
        });

        favoriteBtn.addEventListener('click', () => {
            const currentCard = filteredCards[currentIndex];
            const isFavorite = favorites.some(f => f.id === currentCard.id);
            
            if (isFavorite) {
                favorites = favorites.filter(f => f.id !== currentCard.id);
            } else {
                favorites.push(currentCard);
            }
            
            saveToLocalStorage();
            updateUI();
            updateStats();
            
            if (favoritesSection.classList.contains('open')) {
                renderFavorites();
            }
            
            syncToServer();
        });

        toggleFavoritesBtn.addEventListener('click', () => {
            favoritesSection.classList.toggle('open');
            renderFavorites();
        });

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                filterBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const filter = btn.dataset.filter;
                if (filter === 'all') {
                    filteredCards = [...cards];
                } else {
                    filteredCards = cards.filter(c => c.topic === filter);
                }
                
                currentIndex = 0;
                updateUI();
                saveToLocalStorage();
            });
        });

        // ============ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø ============
        setInterval(() => {
            syncToServer();
        }, SYNC_INTERVAL);

        // ============ –ó–ê–ü–£–°–ö ============
        initTelegramWebApp();
    </script>
</body>
</html>
